{% extends 'base.html' %}
{% load static %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'css/ejemplos/sidebar.css' %}">
{% endblock styles %}


{% block content %}
    {% include 'tuples_lists/ejemplos/sidebar.html' %}
    <main style="padding: 100px 30px;">
        <div class="row mx-auto">
            <div class="col-lg-3" style="content: '';">
            </div>
            <div class="col-lg-8">
                <h3>Ejemplo 1</h3>
                <p>
                    Dada 2 listas de enteros de longitud 4 ingresadas por el usuario, se desea escribir un programa la cual concatena la cabeza de la lista 1 con la cola de la lista 2 y después sume los elementos que se encuentran en la lista resultante de la concatenación
                    NOTA: como aún no se ha visto la sección de reglas de entradas y salidas, usted en su código local declare las variables del ejemplo y dele valores estáticos
                </p>
            </div>
            <div class="col-lg-3" style="content: '';">
            </div>
            <div class="col-lg-4">
                <pre id="explain_code">
                    <code class="language-vb">    <span id="pass1">val list1 = lista_ingresada;</span>
    <span id="pass2" data-index="2">val list2 = lista_ingresada;</span>
    <span id="pass3" data-index="3">val head_one = hd(list1);</span>
    <span id="pass4" data-index="4">val new_list = head_one :: tl(list2);</span>
    <span id="pass5" data-index="5">val element_first = hd(new_list);</span>
    <span id="pass6" data-index="6">val second_first = hd(tl(new_list));</span>
    <span id="pass7" data-index="7">val third_first = hd(tl(tl(new_list)));</span>
    <span id="pass8" data-index="8">val four_first = hd(tl(tl(tl(new_list))));</span>
    <span id="pass9" data-index="9">val suma = element_first + second_first + third_first + four_first</span>
                </code>
            </pre>
                
                <a href="#" id="pass" class="btn btn-danger">Paso a paso</a>
                <a href="#" id="next" class="btn btn-danger desactivate">Siguiente</a>
                <a href="#" id="result" class="btn btn-danger desactivate">Ver resultado</a>
            </div>
            <div class="col-5 mx-auto desactivate" id="container_together">
                <div id="explain" class="col-lg-12">
                    <pre id="explain_code_2">
                        <code class="language-vb"> <span id="code_1">Se define la primera variable que va a obtener la lista 1</span>
  <span id="code_2" class="desactivate">Se define la segunda variable que va a obtener la lista 2</span>                        
  <span id="code_3" class="desactivate">En una variable llamada head_one se almacena el valor de la cabeza de la lista 1</span>
  <span id="code_4" class="desactivate">En otra variable llamada new_list se concatena el valor de la variable head_one y el cuerpo de la lista 2 (Nota para obtener el cuerpo de la lista 2 se usa la función tl)</span>
  <span id="code_5" class="desactivate">Se obtiene el primer elemento de la nueva lista</span>
  <span id="code_6" class="desactivate">Se obtiene el segundo elemento de la nueva lista (En términos generales se obtiene la cabeza del cuerpo de la lista)</span>
  <span id="code_7" class="desactivate">Se obtiene el tercer elemento de la nueva lista (En términos generales se obtiene la cabeza de obtener dos veces el cuerpo de la lista)</span>
  <span id="code_8" class="desactivate">Se obtiene el tercer elemento de la nueva lista (Se aplica de la misma manera pero al tercer nivel)</span>
  <span id="code_9" class="desactivate">Se obtiene el cuarto elemento de la nueva lista (Se aplica de la misma manera pero al cuarto nivel)</span>
                        </code>
                    </pre>
                    <pre id="result_code" class="desactivate">
                        <code class="language-vb">  <span id="resulttag"></span>
                        </code>
                    </pre>
                </div>
                <div id="input" class="col-lg-12 text-center">
                    <h3>Ingrese lista</h3>
                    <span style="font-size: 10px;">Nota para ingresar una lista es necesario escribir los corchetes</span>
                    <input type="text" class="mx-auto mt-3 d-block" placeholder="ex [1,2,3,4]" id="input_number">
                </div>
            </div>
        </div>
    </main>
{% endblock content %}


{% block scripts %}

<script>
    alertify.alert(
        'Para tener en cuenta!', 'En este ejemplo para temas dinámicos, se le pide al usuario ingresar dos listas para poder mostrar el ejemplo, sin embargo, a la hora de realizar el programa en su computador, es necesario que usted defina las variables list1 y list2 de manera estática debido a que aun no se ha explicado acerca de las entradas y salidas en SML. Tema que se va a explicar en un módulo más adelante.', 
        function(){ }
    );

    let global_list = [];
    
    // Function to indentify if the value sent by user is a list
    var check__if_list = (input) => {
        len_ = input.length
        state = input[0] != "[" || input[len_ - 1] != "]" ? false : true
        if(!state){
            return false
        }
        try{
            global_list.push(JSON.parse(input))
            return true
        } catch (error) {
            return false
        }
    }

    $(document).ready(function () {
        init_pass = 1
        init_max = 9
        values = [] 

        $('#pass').on('click',(e)=>{
            e.preventDefault()
            $('#pass').toggle('explode')
            $('#next').toggle('explode')
            $('#container_together').toggle('explode')
            $('#pass1').addClass('color_pass')
        })

        $('#next').on('click',(e) => {
            e.preventDefault()
            id_current = '#pass'+init_pass
            id_next = '#pass'+(init_pass+1)
            id_explain_current = "#code_"+init_pass
            id_explain_next = "#code_"+(init_pass+1)
            init_pass+=1
            state_to_next = true

            if (init_pass == 2 || init_pass == 3){
                num_trans = $('#input_number').val()
                let state = check__if_list(num_trans);
                if(!state){
                    init_pass--;
                    state_to_next = false
                    alertify.alert("Valor invalido","Ingresa un valor valido", function(){ });
                }
                $('#input_number').val("")
                if(init_pass == 3){
                    $('#input').toggle('explode')  
                }
            }
            if (init_pass == init_max){
                $("#result").toggle('')
                $("#next").toggle('')   
            }
            
            if(state_to_next){
                $(id_next).addClass("color_pass")
                $(id_current).removeClass("color_pass")
                $(id_explain_current).toggle('')
                $(id_explain_next).toggle('')
            }
        })

        var show_result = () => {
            var head = global_list[0][0]
            var tail = global_list[1].slice(1);
            var new_list = [head].concat(tail)
            var sum = 0;
            for(let i = 0; i < new_list.length; i++){
                sum += new_list[i];
            }
            return sum
        }
 
        $('#result').on('click',(e) => {
            e.preventDefault()
            $('#result').toggle('')
            $('#explain_code_2').toggle('')
            $('#result_code').toggle('')
            result = "val suma = " + show_result() + " : int"
            $('#resulttag').html(result)
        })
    })
</script>
{% endblock scripts %}